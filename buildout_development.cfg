#This buildout is for local development.

[buildout]

extends = buildout_common.cfg
parts += 
    solr_download
    solr
    rabbitmq 
    rabbitmq_conf 
    libevent
    memcached
    memcached_setup
    supervisor

##############################################################################  
# Aditional stuff to make development easy
##############################################################################
 
eggs +=  
    Babel
    ipython
    ipdb
    Werkzeug
    WebError

##############################################################################  
#Override settings from buildout_common.cfg    
##############################################################################  

[adhocracy_code]
repository = ssh://hg@bitbucket.org/liqd/adhocracy
branch = default
repository_theme = ssh://hg@bitbucket.org/liqd/adhocracy.enquete_theme

[domains]
# generate internal urls with port 5001 to be able to work without a
# proxy (e.g. apache with ReverseProxy, see /etc/vhost.ini.in)
# on port 5001.
main = adhocracy.lan:5001
blog = staging_bundestag_blog.adhocracy.cc

##############################################################################  
# Set up supervisor to run it all
##############################################################################

[supervisor]
programs =
    0 rabbitmq ${buildout:directory}/bin/rabbitmq-server                 
    20 memcached ${memcached:location}/bin/memcached [-l 127.0.0.1 -p ${ports:memcached} -U ${ports:memcached}] 
    30 solr ${buildout:directory}/bin/solr-instance [fg]
    40 adhocracy_background ${buildout:directory}/bin/paster [--plugin=adhocracy background -c ${buildout:directory}/etc/development.ini]
#    45 adhocracy ${buildout:directory}/bin/paster [serve ${buildout:directory}/etc/development.ini]
 
    
